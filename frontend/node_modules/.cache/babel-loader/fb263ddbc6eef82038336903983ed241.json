{"ast":null,"code":"var _jsxFileName = \"/home/iowk/exhibition_map/frontend/src/register.jsx\";\nimport React, { Component } from 'react';\nimport './register.css';\nimport axios from './axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Register extends Component {\n  // Full register page\n  constructor(props) {\n    super(props);\n\n    this.handleOnChangePassword = e => {\n      let errCopy = this.state.err;\n\n      if (this.state.passwordConf === e.target.value || this.state.passwordConf === '') {\n        errCopy.passwordConf = '';\n        this.setState({\n          err: errCopy\n        });\n        this.setState({\n          password: e.target.value\n        });\n      } else {\n        errCopy.passwordConf = 'Confirm password incorrect';\n        this.setState({\n          err: errCopy\n        });\n        this.setState({\n          password: e.target.value\n        });\n      }\n    };\n\n    this.handleOnChangePasswordConf = e => {\n      let errCopy = this.state.err;\n\n      if (this.state.password === e.target.value) {\n        errCopy.passwordConf = '';\n        this.setState({\n          err: errCopy\n        });\n        this.setState({\n          passwordConf: e.target.value\n        });\n      } else {\n        errCopy.passwordConf = 'Confirm password incorrect';\n        this.setState({\n          err: errCopy\n        });\n        this.setState({\n          passwordConf: e.target.value\n        });\n      }\n    };\n\n    this.handleSubmit = event => {\n      // POST username, email and password\n      if (this.state.password === this.state.passwordConf) {\n        axios.post('/map/users/register/', JSON.stringify({\n          username: this.state.username,\n          email: this.state.email,\n          password: this.state.password\n        }), {\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          }\n        }).then(res => {\n          this.clearErr();\n          login(this.state.username, this.state.password).then(res => {\n            axios.get('/map/users/send_acc_email/').then(res => {\n              this.setState({\n                buttomMessage: \"Registration success. Activation mail is sent to \" + this.state.email\n              });\n            }).catch(e => {\n              this.setState({\n                buttomMessage: \"Registration success. Activation mail is not sent due to server error.\"\n              });\n            });\n          }).catch(e => {\n            console.log(e);\n          });\n          this.clearInput();\n        }).catch(e => {\n          console.log(e);\n          this.setState({\n            err: e.response.data\n          });\n        });\n      }\n\n      event.preventDefault();\n    };\n\n    this.state = {\n      username: '',\n      email: '',\n      password: '',\n      passwordConf: '',\n      err: {\n        username: '',\n        email: '',\n        password: '',\n        passwordConf: ''\n      },\n      buttomMessage: ''\n    };\n  }\n\n  clearErr() {\n    let err_cpy = {};\n\n    for (var key in this.state.err) {\n      err_cpy[key] = '';\n    }\n\n    this.setState({\n      err: err_cpy\n    });\n  }\n\n  clearInput() {\n    this.setState({\n      username: ''\n    });\n    this.setState({\n      email: ''\n    });\n    this.setState({\n      password: ''\n    });\n    this.setState({\n      passwordConf: ''\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"register\",\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit.bind(this),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inpDiv\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: this.state.username,\n            onChange: e => this.setState({\n              username: e.target.value\n            }),\n            className: \"inpBox\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"errDiv\",\n          children: this.state.err.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inpDiv\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: this.state.email,\n            onChange: e => this.setState({\n              email: e.target.value\n            }),\n            className: \"inpBox\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"errDiv\",\n          children: this.state.err.email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inpDiv\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            value: this.state.password,\n            onChange: this.handleOnChangePassword,\n            className: \"inpBox\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"errDiv\",\n          children: this.state.err.password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inpDiv\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Confirm Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            value: this.state.passwordConf,\n            onChange: this.handleOnChangePasswordConf,\n            className: \"inpBox\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"errDiv\",\n          children: this.state.err.passwordConf\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Register\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"buttomMessage\",\n        children: this.state.buttomMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Register;","map":{"version":3,"names":["React","Component","axios","Register","constructor","props","handleOnChangePassword","e","errCopy","state","err","passwordConf","target","value","setState","password","handleOnChangePasswordConf","handleSubmit","event","post","JSON","stringify","username","email","headers","then","res","clearErr","login","get","buttomMessage","catch","console","log","clearInput","response","data","preventDefault","err_cpy","key","render","bind"],"sources":["/home/iowk/exhibition_map/frontend/src/register.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport './register.css';\nimport axios from './axios';\n\nclass Register extends Component {\n    // Full register page\n    constructor(props) {\n        super(props);\n        this.state = {\n            username: '',\n            email: '',\n            password: '',\n            passwordConf: '',\n            err: {\n                username: '',\n                email: '',\n                password: '',\n                passwordConf: '',\n            },\n            buttomMessage: '',\n        };\n    }\n    handleOnChangePassword = (e) => {\n        let errCopy = this.state.err;\n        if(this.state.passwordConf===e.target.value || this.state.passwordConf===''){\n            errCopy.passwordConf = '';\n            this.setState({err:errCopy});\n            this.setState({password:e.target.value});\n        }\n        else{\n            errCopy.passwordConf = 'Confirm password incorrect';\n            this.setState({err:errCopy});\n            this.setState({password:e.target.value});\n        }\n    }    \n    handleOnChangePasswordConf = (e) => {\n        let errCopy = this.state.err;\n        if(this.state.password===e.target.value){\n            errCopy.passwordConf = '';\n            this.setState({err:errCopy});\n            this.setState({passwordConf:e.target.value});\n        }\n        else{\n            errCopy.passwordConf = 'Confirm password incorrect';\n            this.setState({err:errCopy});\n            this.setState({passwordConf:e.target.value});\n        }\n    }    \n    clearErr(){\n        let err_cpy = {};\n        for(var key in this.state.err){\n            err_cpy[key] = '';\n        }\n        this.setState({err: err_cpy});\n    }\n    clearInput(){\n        this.setState({username: ''});\n        this.setState({email: ''});\n        this.setState({password: ''});\n        this.setState({passwordConf: ''});\n    }\n    handleSubmit = (event) => {\n        // POST username, email and password\n        if(this.state.password===this.state.passwordConf){\n            axios.post('/map/users/register/', JSON.stringify({\n                username: this.state.username,\n                email: this.state.email,\n                password: this.state.password,\n            }),\n            {\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                },\n            })\n            .then(res => {\n                this.clearErr();\n                login(this.state.username, this.state.password)\n                .then(res => {           \n                    axios.get('/map/users/send_acc_email/')\n                    .then(res => {\n                        this.setState({buttomMessage: \"Registration success. Activation mail is sent to \" + this.state.email});\n                    })\n                    .catch(e => {\n                        this.setState({buttomMessage: \"Registration success. Activation mail is not sent due to server error.\"});\n                    })\n                })\n                .catch(e => {\n                    console.log(e);\n                })\n                this.clearInput();\n            })\n            .catch(e => {\n                console.log(e);\n                this.setState({err: e.response.data});\n            })\n        }\n        event.preventDefault();\n    }\n    render() {\n        return(\n            <div id=\"register\">\n                <form onSubmit={this.handleSubmit.bind(this)}>\n                <div className='inpDiv'>\n                    <span>Username</span>\n                    <input\n                        type='text'\n                        value={this.state.username}\n                        onChange={(e) => this.setState({username: e.target.value})}\n                        className='inpBox'\n                    />\n                </div>\n                <div className='errDiv'>{this.state.err.username}</div>\n                <div className='inpDiv'>\n                    <span>Email</span>\n                    <input\n                        type='text'\n                        value={this.state.email}                     \n                        onChange={(e) => this.setState({email: e.target.value})}\n                        className='inpBox'\n                    />\n                </div>\n                <div className='errDiv'>{this.state.err.email}</div>\n                <div className='inpDiv'>\n                    <span>Password</span>\n                    <input\n                        type='password'\n                        value={this.state.password} \n                        onChange={this.handleOnChangePassword}\n                        className='inpBox'\n                    />\n                </div>\n                <div className='errDiv'>{this.state.err.password}</div>\n                <div className='inpDiv'>\n                    <span>Confirm Password</span>\n                    <input\n                        type='password'\n                        value={this.state.passwordConf} \n                        onChange={this.handleOnChangePasswordConf}\n                        className='inpBox'\n                    />\n                </div>\n                <div className='errDiv'>{this.state.err.passwordConf}</div>\n                <button type=\"submit\">\n                    Register\n                </button>\n                </form>\n                <div className='buttomMessage'>{this.state.buttomMessage}</div>\n            </div>);\n    }\n}\nexport default Register;"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,gBAAP;AACA,OAAOC,KAAP,MAAkB,SAAlB;;;AAEA,MAAMC,QAAN,SAAuBF,SAAvB,CAAiC;EAC7B;EACAG,WAAW,CAACC,KAAD,EAAQ;IACf,MAAMA,KAAN;;IADe,KAgBnBC,sBAhBmB,GAgBOC,CAAD,IAAO;MAC5B,IAAIC,OAAO,GAAG,KAAKC,KAAL,CAAWC,GAAzB;;MACA,IAAG,KAAKD,KAAL,CAAWE,YAAX,KAA0BJ,CAAC,CAACK,MAAF,CAASC,KAAnC,IAA4C,KAAKJ,KAAL,CAAWE,YAAX,KAA0B,EAAzE,EAA4E;QACxEH,OAAO,CAACG,YAAR,GAAuB,EAAvB;QACA,KAAKG,QAAL,CAAc;UAACJ,GAAG,EAACF;QAAL,CAAd;QACA,KAAKM,QAAL,CAAc;UAACC,QAAQ,EAACR,CAAC,CAACK,MAAF,CAASC;QAAnB,CAAd;MACH,CAJD,MAKI;QACAL,OAAO,CAACG,YAAR,GAAuB,4BAAvB;QACA,KAAKG,QAAL,CAAc;UAACJ,GAAG,EAACF;QAAL,CAAd;QACA,KAAKM,QAAL,CAAc;UAACC,QAAQ,EAACR,CAAC,CAACK,MAAF,CAASC;QAAnB,CAAd;MACH;IACJ,CA5BkB;;IAAA,KA6BnBG,0BA7BmB,GA6BWT,CAAD,IAAO;MAChC,IAAIC,OAAO,GAAG,KAAKC,KAAL,CAAWC,GAAzB;;MACA,IAAG,KAAKD,KAAL,CAAWM,QAAX,KAAsBR,CAAC,CAACK,MAAF,CAASC,KAAlC,EAAwC;QACpCL,OAAO,CAACG,YAAR,GAAuB,EAAvB;QACA,KAAKG,QAAL,CAAc;UAACJ,GAAG,EAACF;QAAL,CAAd;QACA,KAAKM,QAAL,CAAc;UAACH,YAAY,EAACJ,CAAC,CAACK,MAAF,CAASC;QAAvB,CAAd;MACH,CAJD,MAKI;QACAL,OAAO,CAACG,YAAR,GAAuB,4BAAvB;QACA,KAAKG,QAAL,CAAc;UAACJ,GAAG,EAACF;QAAL,CAAd;QACA,KAAKM,QAAL,CAAc;UAACH,YAAY,EAACJ,CAAC,CAACK,MAAF,CAASC;QAAvB,CAAd;MACH;IACJ,CAzCkB;;IAAA,KAuDnBI,YAvDmB,GAuDHC,KAAD,IAAW;MACtB;MACA,IAAG,KAAKT,KAAL,CAAWM,QAAX,KAAsB,KAAKN,KAAL,CAAWE,YAApC,EAAiD;QAC7CT,KAAK,CAACiB,IAAN,CAAW,sBAAX,EAAmCC,IAAI,CAACC,SAAL,CAAe;UAC9CC,QAAQ,EAAE,KAAKb,KAAL,CAAWa,QADyB;UAE9CC,KAAK,EAAE,KAAKd,KAAL,CAAWc,KAF4B;UAG9CR,QAAQ,EAAE,KAAKN,KAAL,CAAWM;QAHyB,CAAf,CAAnC,EAKA;UACIS,OAAO,EAAE;YACL,UAAU,kBADL;YAEL,gBAAgB;UAFX;QADb,CALA,EAWCC,IAXD,CAWMC,GAAG,IAAI;UACT,KAAKC,QAAL;UACAC,KAAK,CAAC,KAAKnB,KAAL,CAAWa,QAAZ,EAAsB,KAAKb,KAAL,CAAWM,QAAjC,CAAL,CACCU,IADD,CACMC,GAAG,IAAI;YACTxB,KAAK,CAAC2B,GAAN,CAAU,4BAAV,EACCJ,IADD,CACMC,GAAG,IAAI;cACT,KAAKZ,QAAL,CAAc;gBAACgB,aAAa,EAAE,sDAAsD,KAAKrB,KAAL,CAAWc;cAAjF,CAAd;YACH,CAHD,EAICQ,KAJD,CAIOxB,CAAC,IAAI;cACR,KAAKO,QAAL,CAAc;gBAACgB,aAAa,EAAE;cAAhB,CAAd;YACH,CAND;UAOH,CATD,EAUCC,KAVD,CAUOxB,CAAC,IAAI;YACRyB,OAAO,CAACC,GAAR,CAAY1B,CAAZ;UACH,CAZD;UAaA,KAAK2B,UAAL;QACH,CA3BD,EA4BCH,KA5BD,CA4BOxB,CAAC,IAAI;UACRyB,OAAO,CAACC,GAAR,CAAY1B,CAAZ;UACA,KAAKO,QAAL,CAAc;YAACJ,GAAG,EAAEH,CAAC,CAAC4B,QAAF,CAAWC;UAAjB,CAAd;QACH,CA/BD;MAgCH;;MACDlB,KAAK,CAACmB,cAAN;IACH,CA5FkB;;IAEf,KAAK5B,KAAL,GAAa;MACTa,QAAQ,EAAE,EADD;MAETC,KAAK,EAAE,EAFE;MAGTR,QAAQ,EAAE,EAHD;MAITJ,YAAY,EAAE,EAJL;MAKTD,GAAG,EAAE;QACDY,QAAQ,EAAE,EADT;QAEDC,KAAK,EAAE,EAFN;QAGDR,QAAQ,EAAE,EAHT;QAIDJ,YAAY,EAAE;MAJb,CALI;MAWTmB,aAAa,EAAE;IAXN,CAAb;EAaH;;EA2BDH,QAAQ,GAAE;IACN,IAAIW,OAAO,GAAG,EAAd;;IACA,KAAI,IAAIC,GAAR,IAAe,KAAK9B,KAAL,CAAWC,GAA1B,EAA8B;MAC1B4B,OAAO,CAACC,GAAD,CAAP,GAAe,EAAf;IACH;;IACD,KAAKzB,QAAL,CAAc;MAACJ,GAAG,EAAE4B;IAAN,CAAd;EACH;;EACDJ,UAAU,GAAE;IACR,KAAKpB,QAAL,CAAc;MAACQ,QAAQ,EAAE;IAAX,CAAd;IACA,KAAKR,QAAL,CAAc;MAACS,KAAK,EAAE;IAAR,CAAd;IACA,KAAKT,QAAL,CAAc;MAACC,QAAQ,EAAE;IAAX,CAAd;IACA,KAAKD,QAAL,CAAc;MAACH,YAAY,EAAE;IAAf,CAAd;EACH;;EAuCD6B,MAAM,GAAG;IACL,oBACI;MAAK,EAAE,EAAC,UAAR;MAAA,wBACI;QAAM,QAAQ,EAAE,KAAKvB,YAAL,CAAkBwB,IAAlB,CAAuB,IAAvB,CAAhB;QAAA,wBACA;UAAK,SAAS,EAAC,QAAf;UAAA,wBACI;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QADJ,eAEI;YACI,IAAI,EAAC,MADT;YAEI,KAAK,EAAE,KAAKhC,KAAL,CAAWa,QAFtB;YAGI,QAAQ,EAAGf,CAAD,IAAO,KAAKO,QAAL,CAAc;cAACQ,QAAQ,EAAEf,CAAC,CAACK,MAAF,CAASC;YAApB,CAAd,CAHrB;YAII,SAAS,EAAC;UAJd;YAAA;YAAA;YAAA;UAAA,QAFJ;QAAA;UAAA;UAAA;UAAA;QAAA,QADA,eAUA;UAAK,SAAS,EAAC,QAAf;UAAA,UAAyB,KAAKJ,KAAL,CAAWC,GAAX,CAAeY;QAAxC;UAAA;UAAA;UAAA;QAAA,QAVA,eAWA;UAAK,SAAS,EAAC,QAAf;UAAA,wBACI;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QADJ,eAEI;YACI,IAAI,EAAC,MADT;YAEI,KAAK,EAAE,KAAKb,KAAL,CAAWc,KAFtB;YAGI,QAAQ,EAAGhB,CAAD,IAAO,KAAKO,QAAL,CAAc;cAACS,KAAK,EAAEhB,CAAC,CAACK,MAAF,CAASC;YAAjB,CAAd,CAHrB;YAII,SAAS,EAAC;UAJd;YAAA;YAAA;YAAA;UAAA,QAFJ;QAAA;UAAA;UAAA;UAAA;QAAA,QAXA,eAoBA;UAAK,SAAS,EAAC,QAAf;UAAA,UAAyB,KAAKJ,KAAL,CAAWC,GAAX,CAAea;QAAxC;UAAA;UAAA;UAAA;QAAA,QApBA,eAqBA;UAAK,SAAS,EAAC,QAAf;UAAA,wBACI;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QADJ,eAEI;YACI,IAAI,EAAC,UADT;YAEI,KAAK,EAAE,KAAKd,KAAL,CAAWM,QAFtB;YAGI,QAAQ,EAAE,KAAKT,sBAHnB;YAII,SAAS,EAAC;UAJd;YAAA;YAAA;YAAA;UAAA,QAFJ;QAAA;UAAA;UAAA;UAAA;QAAA,QArBA,eA8BA;UAAK,SAAS,EAAC,QAAf;UAAA,UAAyB,KAAKG,KAAL,CAAWC,GAAX,CAAeK;QAAxC;UAAA;UAAA;UAAA;QAAA,QA9BA,eA+BA;UAAK,SAAS,EAAC,QAAf;UAAA,wBACI;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QADJ,eAEI;YACI,IAAI,EAAC,UADT;YAEI,KAAK,EAAE,KAAKN,KAAL,CAAWE,YAFtB;YAGI,QAAQ,EAAE,KAAKK,0BAHnB;YAII,SAAS,EAAC;UAJd;YAAA;YAAA;YAAA;UAAA,QAFJ;QAAA;UAAA;UAAA;UAAA;QAAA,QA/BA,eAwCA;UAAK,SAAS,EAAC,QAAf;UAAA,UAAyB,KAAKP,KAAL,CAAWC,GAAX,CAAeC;QAAxC;UAAA;UAAA;UAAA;QAAA,QAxCA,eAyCA;UAAQ,IAAI,EAAC,QAAb;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAzCA;MAAA;QAAA;QAAA;QAAA;MAAA,QADJ,eA8CI;QAAK,SAAS,EAAC,eAAf;QAAA,UAAgC,KAAKF,KAAL,CAAWqB;MAA3C;QAAA;QAAA;QAAA;MAAA,QA9CJ;IAAA;MAAA;MAAA;MAAA;IAAA,QADJ;EAiDH;;AAjJ4B;;AAmJjC,eAAe3B,QAAf"},"metadata":{},"sourceType":"module"}